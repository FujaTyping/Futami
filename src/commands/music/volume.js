const { Command, container } = require('@sapphire/framework');
const { EmbedBuilder } = require('discord.js');

const config = require('../../config.json');
const color = config.chat.color
const emote = config.default

class VolumeCommand extends Command {
    constructor(context, options) {
        super(context, {
            ...options,
            name: 'volume',
            aliases: ['vol'],
            description: 'change the song volume',
            preconditions: ['InVoiceChannel']
        });
    }

    async messageRun(message, args) {
        const { client } = container;

        const queue = client.distube.getQueue(message)

        if (!queue) {
            const Content = new EmbedBuilder()
                .setColor(color)
                .setTitle(`${emote.warning} ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô !!`)
                .setDescription('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡∏•‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡∏≤‡∏™‡∏±‡∏Å‡πÄ‡∏û‡∏•‡∏á‡∏î‡∏π‡∏™‡∏¥')
                .setTimestamp()

            return message.channel.send({ embeds: [Content] })
        } else {
            const Value = await args.rest('string');
            const volume = parseInt(Value)

            if (isNaN(volume)) {
                const Content = new EmbedBuilder()
                    .setColor(color)
                    .setTitle(`${emote.warning} ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô !!`)
                    .setDescription('‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 0-500 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÑ‡∏î‡πâ')
                    .setTimestamp()

                return message.channel.send({ embeds: [Content] })
            } else {
                if (volume > 500) {
                    const Content = new EmbedBuilder()
                        .setColor(color)
                        .setTitle('üîä ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á')
                        .setDescription(`${emote.error} ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏õ‡πá‡∏ô : **` + volume + `** % ‡πÑ‡∏î‡πâ\n${emote.warning} ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 0-500 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô`)
                        .setFooter({ text: `‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÇ‡∏î‡∏¢ : ${message.author.username}`, iconURL: message.author.avatarURL() })
                        .setTimestamp()

                    return message.channel.send({ embeds: [Content] })
                } else {
                    queue.setVolume(volume)

                    const Content = new EmbedBuilder()
                        .setColor(color)
                        .setTitle('üîä ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á')
                        .setDescription('‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏õ‡πá‡∏ô : **' + volume + `** %\n${emote.warning} ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏´‡∏π`)
                        .setFooter({ text: `‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÇ‡∏î‡∏¢ : ${message.author.username}`, iconURL: message.author.avatarURL() })
                        .setTimestamp()

                    return message.channel.send({ embeds: [Content] })
                }
            }
        }
    }
}
module.exports = {
    VolumeCommand
};